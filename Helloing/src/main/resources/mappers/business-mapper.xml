<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="businessMapper">
 
  <resultMap id="businessResultSet" type="business">
  	<result column="BUSINESS_NO" 			property="businessNo" />
  	<result column="MEM_NO" 				property="memNo" />
  	<result column="BUSINESS_NAME" 			property="businessName" />
  	<result column="ADDRESS" 				property="address" />
  	<result column="BUSINESS_ENROLLDATE" 	property="businessEnrollDate" />
  </resultMap>
  
  
  <resultMap id="roomPaymentResultSet" type="roomPayment">
  	<result column="START_DATE" property="startDate"/>
  	<result column="END_DATE" property="endDate"/>
  	<result column="ACCOMM_NAME" property="accName"/>
  	<result column="ROOM_NAME" property="roomName"/>
  	<result column="MEM_NAME" property="memName"/>
  	<result column="HEAD_COUNT" property="headCount"/>
  	<result column="PRICE" property="price"/>
  	<result column="CATEGORY" property="category"/>
  	
  </resultMap>
 
	<select id="loginCompany" parameterType="_int" resultMap="businessResultSet">
		select
				business_no,
				mem_no,
				business_name,
				address,
				business_enrolldate
		  from
		  		business
		 where
		 		mem_no = #{ memNo }
	</select>


	<insert id="insertCompany" parameterType="business" >
		insert
		  into
		  		business
		  		(
		  		mem_no,		  		
		  		business_Name,
		  		business_No,
		  		address
		  		)
		 values
		 	 	(
		 	 	#{ memNo },
		 		#{ businessName },
		 		#{ businessNo },
		 		#{ address }
		 		)
	</insert>
	
	<update id="updateBusinessMember" parameterType="business">
		UPDATE
		       BUSINESS
		   SET
		       ADDRESS = #{ address }
		 WHERE
		       BUSINESS_NO = #{ businessNo }
	</update>
	
	<!-- 숙소 객실 예약날짜 확인 -->
	<select id="checkBookDate" parameterType="string" resultMap="roomPaymentResultSet">
		SELECT
		       TO_CHAR(START_DATE, 'YYYY-MM-DD') START_DATE
		       ,TO_CHAR(END_DATE, 'YYYY-MM-DD') END_DATE
		       
		  FROM
		       ROOM_PAYMENT
		 WHERE 
		       ROOM_NO = 1
	</select>
	
	<!-- 숙소 객실 날짜별 예약정보 -->
	<select id="selectBookInfo" parameterType="roomPayment" resultMap="roomPaymentResultSet">
		SELECT
		       CATEGORY
       		   ,ACCOMM_NAME
       		   ,ROOM_NAME
		       ,MEM_NAME
		       ,HEAD_COUNT
		       ,START_DATE
		       ,RP.END_DATE
		       ,RP.PRICE
		  FROM
		       ROOM_PAYMENT RP
		  JOIN
		       ACCOMM USING(ACCOMM_NO)
		  JOIN
		       ROOM USING(ROOM_NO)
		  JOIN 
		       MEMBER USING(MEM_NO)
		 WHERE
		       START_DATE <![CDATA[ <= ]]> #{chooseDate}
		   AND
		       RP.END_DATE > #{chooseDate}
		   AND
		       ROOM_NO = #{roomNo}
	</select>




































</mapper>
