<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="adminMapper">

	<resultMap id="chatbotResultSet" type="chatbot">
		<result column="CHATBOT_Q" property="chatbotQ"/>
		<result column="CHATBOT_A" property="chatbotA"/>
	</resultMap>
	
	<!-- 챗봇Q 중복 확인 -->
	<select id="selectChatbotQ" parameterType="chatbot" resultType="_int">
		SELECT 
		       COUNT(*)
		  FROM 
		       CHATBOT
		 WHERE
		       CHATBOT_Q = #{chatbotQ}		
	</select>
	
	<!-- 챗봇 등록 -->
	<insert id="insertChatbot" parameterType="chatbot">
		INSERT
		  INTO
		       CHATBOT
		VALUES
		       (
		       #{chatbotQ}
		       ,#{chatbotA}
		       )
	</insert>
	
	<!-- 챗봇 목록 수 조회 -->
	<select id="selecChatbottListCount" resultType="_int">
		SELECT 
		       COUNT(*)
		  FROM 
		       CHATBOT
	</select>
	
	<!-- 챗봇 전체 조회 -->
	<select id="selectChatbotList" resultMap="chatbotResultSet">
		SELECT
		       CHATBOT_Q
		       ,CHATBOT_A
		  FROM
		       CHATBOT
	</select>
	
	<!-- 챗봇 수정시 챗봇Q 중복 조회 -->
	<select id="selectChatbotQUpdate" parameterType="chatbot" resultType="_int">
		SELECT
			   COUNT(*)
		  FROM
		       CHATBOT
		 WHERE
		       CHATBOT_Q = #{chatbotQ}
		   AND
		       NOT CHATBOT_Q = #{originChatbotQ}
	</select>
	
	<!-- 챗봇 수정 -->
	<update id="updateChatbot" parameterType="chatbot" >
		UPDATE
		       CHATBOT
		   SET
		       CHATBOT_Q = #{chatbotQ}
		       ,CHATBOT_A = #{chatbotA}
		 WHERE
		       CHATBOT_Q = #{originChatbotQ}
	</update>
	
	<!-- 챗봇 삭제 -->
	<delete id="deleteChatbot" parameterType="string">
		DELETE	
		  FROM 
		       CHATBOT
		 WHERE
		       CHATBOT_Q = #{chatbotQ}
	</delete>
	
	<!-- 챗봇 검색된 목록 수 조회 -->
	<select id="selectSearchChatbotCount" parameterType="hashMap" resultType="_int">
		SELECT 
			   COUNT(*)
		  FROM 
		       CHATBOT
		 WHERE
		 	<if test="condition == 'chatbotName'">
		    	CHATBOT_Q
		 	</if>
		 	<if test="condition == 'chatbotContent'">
		 		CHATBOT_A 
		 	</if>
		 		LIKE '%' || #{keyword} || '%'
	</select>
	
	<!-- 챗봇 검색 목록 조회 -->
	<select id="searchChatbot" parameterType="hashMap" resultMap="chatbotResultSet">
		SELECT
			   CHATBOT_Q,
			   CHATBOT_A
	 	  FROM
	 	       CHATBOT
	 	 WHERE
		 	<if test="condition == 'chatbotName'">
		    	CHATBOT_Q
		 	</if>
		 	<if test="condition == 'chatbotContent'">
		 		CHATBOT_A 
		 	</if>
		 		LIKE '%' || #{keyword} || '%'
	</select>
	
	<!-- 챗봇A 조회 -->
	<select id="selectChatbotA" parameterType="List" resultMap="chatbotResultSet">
		SELECT 
		 	   CHATBOT_Q,
			   CHATBOT_A
	 	  FROM
	 	       CHATBOT
	 	 WHERE 
	 	 <foreach collection="List" item="item"
	 	 	open="(" separator="AND" close=")">
	 	       CHATBOT_Q LIKE '%' || #{item} || '%'
	 	 </foreach>
	</select>
</mapper>